---
import PageLayout from "@/layouts/Base.astro";
import { getCollection } from "astro:content";

// Fetch challenges from the "challenge" collection, similar to how posts are fetched
const challenges = await getCollection("challenge", ({ data }) => {
  return import.meta.env.PROD ? !data.draft : true;  // Filter based on the environment
});
---

<PageLayout>
  <div class="space-y-6">
    <h1 class="title">Research Challenges</h1>
    <p>
      Psycho Virtual presents a series of open research challenges in the field of zero-knowledge proofs and cryptography. We invite researchers, cryptographers, and enthusiasts to explore these questions and contribute to advancing the state of the art in these areas.
    </p>
    <div class="space-y-4">
      {challenges.map((challenge, index) => (
        <div class="challenge-item bg-accent-2 rounded-lg p-6" data-index={index}>
          <h2 class="text-xl font-semibold mb-2 cursor-pointer text-accent">{challenge.data.title}</h2>
          <div class="challenge-description hidden text-text">
            <challenge.Content />  <!-- Render the markdown content for each challenge -->
          </div>
        </div>
      ))}
    </div>
    <p class="mt-8">
      If you're interested in tackling these challenges or discussing potential solutions, please reach out to us on
      <a
        aria-label="telegram group"
        class="cactus-link inline-block"
        href="https://t.me/+dyWKxFrVcMk2NjYx"
        rel="noopener noreferrer"
        target="_blank"
      >
        Telegram
      </a>.
    </p>
  </div>
</PageLayout>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const challengeItems = document.querySelectorAll('.challenge-item');
    challengeItems.forEach(item => {
      const title = item.querySelector('h2');
      const description = item.querySelector('.challenge-description');
      title.addEventListener('click', () => {
        description.classList.toggle('hidden');
      });
    });
  });
</script>

<style>
  .challenge-item {
    transition: all 0.3s ease;
  }
  .challenge-item:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
  }
</style>
